# Prompt 8 — Cosmos: прогнозная турбулентность из Monte Carlo

## Что изменено
- Для планеты `stressTest` в Cosmos используется `mcLast` (последний сохранённый Monte Carlo результат), если он есть.
- Halo для `stressTest` теперь отражает **прогнозную турбулентность**, а не только эвристику по score/confidence.
- В панели «Последние действия» при выборе `stressTest` добавлен блок прогноза с:
  - вероятностью провала,
  - квантилями runway `p10/p50/p90`,
  - уровнем неопределённости,
  - мини-интервалом `p10–p90` + маркером `p50`.

Если `mcLast` отсутствует, Cosmos показывает прежний/нейтральный halo (эвристика) и подсказку: **«Запусти Monte Carlo в Стресс-тесте»**.

## Формула turbulence и пороги
Обозначения:
- `ruin` = `ruinProb` в нормализованном виде `0..1`.
  - В текущем Monte Carlo `ruinProb` хранится в процентах (`0..100`), поэтому для формулы используется деление на 100.
- `uncertainty` = `clamp((p90 - p10) / max(1, p50), 0..1)`.
  - Это простая нормализация относительной ширины интервала прогнозов runway.

Итог:
- `turbulence = clamp(0.7 * ruin + 0.3 * uncertainty, 0..1)`.

Пороги:
- badge `RISK` для `stressTest`, если `ruinProb >= 20%` (константа `MC_RISK_BADGE_THRESHOLD = 0.2`).
- Вербальная шкала неопределённости:
  - низкая: `< 0.3`
  - средняя: `0.3..0.6`
  - высокая: `>= 0.6`

## Что означает ruinProb
`ruinProb` — это оценка вероятности «руины/провала» в рамках выбранной модели, горизонта и входных предположений Monte Carlo.
Это **не истина** и не гарантия исхода: значение зависит от качества входных данных, выбранного горизонта, параметров волатильности и сценарных допущений.

## Как читать p10 / p50 / p90 и интервал p10–p90
- `p10`: «пессимистичный» ориентир runway (10-й процентиль).
- `p50`: медианный ориентир (50-й процентиль).
- `p90`: «оптимистичный» ориентир runway (90-й процентиль).

Интервал `p10–p90` показывает диапазон, в котором лежит основная масса сценариев модели.
Чем шире интервал относительно `p50`, тем выше неопределённость прогноза.
