# Observation Store v1

## Структура `observations`

В persisted state добавлен блок:

```ts
observations: {
  cashflowMonthly: Array<{
    ym: string;      // формат YYYY-MM
    income: number;  // >= 0
    expense: number; // >= 0
  }>;
}
```

## Правила cap / sort / sanitize

Для `cashflowMonthly` применяются правила:

1. Валидация `ym`: только `YYYY-MM` (месяцы 01..12).
2. Санитизация чисел:
   - `NaN`, `undefined`, пустые значения -> `0`;
   - отрицательные значения -> `0`.
3. Дубликаты месяца схлопываются по ключу `ym` (последняя запись месяца побеждает).
4. Сортировка по `ym` по возрастанию.
5. Лимит `cap = 36`: храним только последние 36 месяцев (FIFO по времени).

## Как вводить месяцы

- Экран: `#/history`.
- Базовый сценарий:
  1. Нажать `+ месяц` для добавления следующего месяца.
  2. Ввести доход/расход (если поля пустые, сохранятся как `0`).
  3. Нажать `Сохранить месяц`.
- Дополнительно:
  - `удалить` удаляет конкретный месяц из таблицы;
  - `очистить` удаляет всю историю;
  - `net` пересчитывается автоматически как `income - expense`.
